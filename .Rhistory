ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n')
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n')
ct3 <- cor.test(sseekfreq,sprooffreq,method="pearson")
smoothScatter(sseekfreq,sprooffreq,las=1)
points(sseekfreq,sprooffreq,pch=19,cex=.2)
rect(sseek.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=sseek.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct3$estimate),"\nP =",sprintf("%.2e",ct3$p.value)), bty='n')
dev.off()
shattered.regions
cnv.breaks
break.density
?
?break.density
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
chromosome.limit.coords()
chromosome.limit.coords
break.density()
break.density
chr.lim <- d3gb.chr.lim(genome.v = genome.v)
chr.lim <- d3gb.chr.lim(genome.v = "hg19")
chr.lim
chr.lim <- d3gb.chr.lim(genome.v = "hg38")
chr.lim
# run shattered.regions for each dataset
## We defiune chromosome list and coordinates in order to be able to compare across different runs
chrlist = paste("chr",c(1:22,"X"),sep="")
chr.lim.hg19 <- d3gb.chr.lim(genome.v = "hg19")
chr.lim.hg38 <- d3gb.chr.lim(genome.v = "hg38")
shreg_ccle <- shattered.regions(cnv_brca_ccle,svc_brca_ccle,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist=chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
shreg_tcga <- shattered.regions.cnv(cnv_brca_ccle,
fc.pct = 0.1,
chrlist = chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
shreg_pcawg <- shattered.regions(cnv_brca_pcawg,svc_brca_pcawg,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist = chrlist, chr.lim = chr.lim.hg38,
verbose=FALSE)
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
shreg_tcga <- shattered.regions.cnv(cnv_brca_ccle,
fc.pct = 0.1,
chrlist = chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
colnames(shreg_tcga@high.density.regions)[1:10]
colnames(shreg_ccle@high.density.regions)[1:10]
shreg_ccle <- shattered.regions(cnv_brca_ccle,svc_brca_ccle,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist=chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
colnames(shreg_ccle@high.density.regions)[1:10]
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
shreg_ccle <- shattered.regions(cnv_brca_ccle,svc_brca_ccle,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist=chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
shreg_tcga <- shattered.regions.cnv(cnv_brca_ccle,
fc.pct = 0.1,
chrlist = chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
shreg_pcawg <- shattered.regions(cnv_brca_pcawg,svc_brca_pcawg,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist = chrlist, chr.lim = chr.lim.hg38,
verbose=FALSE)
colnames(shreg_ccle@high.density.regions)[1:10]
colnames(shreg_tcga@high.density.regions)[1:10]
layout(matrix(c(1,2,3,4,5,6),3,2,
byrow = TRUE),widths = c(2,6))
par(mar=c(4,4,3,1))
fpt_ccle <- freq.p.test(shreg_ccle@high.density.regions.hc)
par(mar=c(3,4,3,4))
shattered.map.plot(shreg_ccle,freq.cut = fpt_ccle@freq.cut)
text(4e8,fpt_ccle@freq.cut+0.5,"fdr < 0.05",cex=1.1)
par(mar=c(4,4,3,1))
fpt_tcga <- freq.p.test(shreg_tcga@high.density.regions.hc)
par(mar=c(3,4,3,4))
shattered.map.plot(shreg_tcga,freq.cut = fpt_tcga@freq.cut)
text(4e8,fpt_tcga@freq.cut+0.6,"fdr < 0.05",cex=1.1)
par(mar=c(4,4,3,1))
fpt_pcawg <- freq.p.test(shreg_pcawg@high.density.regions.hc)
par(mar=c(3,4,3,4))
shattered.map.plot(shreg_pcawg,freq.cut = fpt_pcawg@freq.cut)
text(4e8,fpt_pcawg@freq.cut+1,"fdr < 0.05",cex=1.1)
hs_sccle <- hot.spot.samples(shreg_ccle[[hh]],freq.cut = fpt_ccle@freq.cut)
hs_sccle <- hot.spot.samples(shreg_ccle,freq.cut = fpt_ccle@freq.cut)
hs_tcga <- hot.spot.samples(shreg_tcga,freq.cut = fpt_tcga@freq.cut)
hs_sccle
hs_tcga
hs_stcga <- hot.spot.samples(shreg_tcga,freq.cut = fpt_tcga@freq.cut)
shregfreq <- apply(sregs.mock[[hh]]@high.density.regions.hc,2,sum)
sseekfreq <- apply(sseek.mock[[hh]]@high.density.regions.hc,2,sum)
sprooffreq <- apply(sproof.mock[[hh]]@high.density.regions.hc,2,sum)
scclefreq <- apply(shreg_ccle@high.density.regions.hc,2,sum)
stcgafreq <- apply(shreg_tcga@high.density.regions.hc,2,sum)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
ct4
smoothScatter(scclefreq,stcgafreq,las=1)
dev.off()
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n')
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n')
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n')
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n')
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n')
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n')
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex.1.2)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n')
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n')
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.2)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.2)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.2)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.2)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.4)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.4)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.4)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5)
dev.off()
?llegend
?legend
mycol <- rgb(255, 255, 255, max = 255, alpha = 125)
mycol <- rgb(255, 255, 255, max = 255, alpha = 125)
mycol <- rgb(255, 255, 255, max = 255, alpha = 125)
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg=mycol)
dev.off()
mycol <- rgb(255, 255, 255, max = 255, alpha = 0)
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg=mycol)
dev.off()
mycol <- rgb(255, 255, 255, max = 255, alpha = 255)
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg=mycol)
dev.off()
mycol <-"white"
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg=mycol)
dev.off()
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg=mycol)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), bty='n',cex=1.5,bg="white")
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)),cex=1.5,bg="white")
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)),cex=1.5,bg="white",border="white")
?legend
mycol <- rgb(255, 255, 255, max = 255, alpha = 155)
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.5)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.5)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.5)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), box.col=mycol,cex=1.5,bg=mycol)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.2)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.2)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.3)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), box.col=mycol,cex=1.5,bg=mycol)
dev.off()
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.3)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.3)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1)
points(scclefreq,stcgafreq,pch=19,cex=.3)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.3)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), box.col=mycol,cex=1.5,bg=mycol)
dev.off()
4000/150
4000/100
37.5 *3
13275
40*100
pdf("Figures/corrplots_v2.pdf",width=8,height=2.5)
par(mfrow=c(1,3),mar=c(4,4,1,1))
ct1 <- cor.test(shregfreq,sseekfreq,method="pearson")
smoothScatter(shregfreq,sseekfreq,las=1)
points(shregfreq,sseekfreq,pch=19,cex=.3)
rect(shreg.fpt@freq.cut,sseek.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sseek.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct1$estimate),"\nP =",sprintf("%.2e",ct1$p.value)), bty='n',cex=1.5)
ct2 <- cor.test(shregfreq,sprooffreq,method="pearson")
smoothScatter(shregfreq,sprooffreq,las=1)
points(shregfreq,sprooffreq,pch=19,cex=.3)
rect(shreg.fpt@freq.cut,sproof.fpt@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=shreg.fpt@freq.cut,lty=3,lwd=.3)
abline(h=sproof.fpt@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct2$estimate),"\nP =",sprintf("%.2e",ct2$p.value)), bty='n',cex=1.5)
ct4 <- cor.test(scclefreq,stcgafreq,method="pearson")
smoothScatter(scclefreq,stcgafreq,las=1,cex.lab=1.5)
points(scclefreq,stcgafreq,pch=19,cex=.3)
rect(fpt_ccle@freq.cut,fpt_tcga@freq.cut,100,100,border=NA,col=rgb(0.3, 0.3, 0.3, alpha = 0.3))
abline(v=fpt_ccle@freq.cut,lty=3,lwd=.3)
abline(h=fpt_tcga@freq.cut,lty=3,lwd=.3)
legend("bottomright", paste("cor =",sprintf("%.2f",ct4$estimate),"\nP =",sprintf("%.2e",ct4$p.value)), box.col=mycol,cex=1.5,bg=mycol)
dev.off()
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
shreg_ccle <- shattered.regions(cnv_brca_ccle,svc_brca_ccle,
fc.pct = 0.1, interleaved.cut = 0.33,
chrlist=chrlist, chr.lim = chr.lim.hg19,
verbose=FALSE)
detach("package:svpluscnv", unload=TRUE)
library(svpluscnv)
